<div>

# Mobilne Aplikacije

**Nositelj**: doc. dr. sc. Nikola Tanković  
**Izvođač**: dr. sc. Robert Šajina  
**Asistent**: mag. inf. Alesandro Žužić  

**Ustanova**: Sveučilište Jurja Dobrile u Puli, Fakultet informatike u Puli

<p style="float: clear; display: flex; gap: 8px; align-items: center;" class="font-brioni text-sm whitespace-nowrap">
    <img src="../Logo/fipu_logo.svg" style="height: 96px; box-shadow: none !important;" class="mr-4"></img>
    Fakultet informatike u Puli
</p>

# [3] - Interakcija s elementima (FoodTracker)

**Posljednje ažurirano:** 19. studenog 2025.

## Sadržaj
<!-- TOC -->
- [Sadržaj](#sadržaj)
- [Dohvaćanje referenci UI elemenata](#dohvaćanje-referenci-ui-elemenata)
- [Dodavanje slušatelja događaja (*Event Listener*)](#dodavanje-slušatelja-događaja-event-listener)
    - [Logiranje poruka](#logiranje-poruka)
    - [Toast poruke](#toast-poruke)
- [Druge metode elementa](#druge-metode-elementa)
- [FoodTracker Zadatak](#foodtracker-zadatak)
    - [Primjer rješenja](#primjer-rješenja)
<!-- /TOC -->

## Dohvaćanje referenci UI elemenata

U prošloj skripti smo naučili kako definirati izgled aplikacije pomoću XML datoteka. Dodavali smo različite UI elemente (*gumbi, tekstualna polja, liste itd.*) u datoteku `activity_main.xml`. Međutim, samo definiranje izgleda nije dovoljno za interakciju s tim elementima. Potrebno je povezati te elemente s logikom aplikacije u Java ili Kotlin kôdu.

Za interakciju s UI elementima (*kao što su gumbi, tekstualna polja, liste itd.*), potrebno je dohvatiti njihove reference u kôdu. To se obično radi pomoću metode `findViewById()`, koja omogućuje pristup elementima definiranim u XML datotekama izgleda (*layout*).

<div class="page"></div>

Primjer XML definicije gumba s ID atributom:
```xml
...
<Button
    ...
    android:id="@+id/my_button"
    android:text="Klikni me!" />
...
```
Primjer dohvaćanja reference na gumb u `MainActivity.java` unutar `onCreate()` metode:
```java
Button myButton = findViewById(R.id.my_button);
```

> Potrebno je osigurati da se `findViewById()` poziva nakon `setContentView()`, jer se na taj način postavlja sadržaj aktivnosti i omogućuje pristup elementima izgleda.

> Isto tako treba uvesti odgovarajuću klasu za UI elemente koje koristimo, kao što je `import android.widget.Button;` za gumb.

Pa cijeli MainActivity.java može izgledati ovako:

```java
package hr.fipu.testing;

import android.os.Bundle;
import android.widget.Button;

import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
        Button myButton = findViewById(R.id.my_button);
    }
}
```

<div class="page"></div>

## Dodavanje slušatelja događaja (*Event Listener*)

Sada možemo koristiti `myButton` objekt za postavljanje slušatelja događaja (*event listener*), kao što je `setOnClickListener()`, kako bismo definirali što se događa kada korisnik klikne na gumb:

```java
myButton.setOnClickListener(v -> {
    // Radnja koja se izvršava kada se gumb klikne
    Log.d("MainActivity", "Gumb je kliknut!");
});
```

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Interakcija.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Logcat: Gumb je kliknut!</i></p>
</div>

Također možemo koristiti druge metode za interakciju s elementima, kao što su `setOnLongClickListener()`, `setOnFocusChangeListener()`, itd., ovisno o vrsti elementa i željenoj interakciji.

### Logiranje poruka

Za ispis poruka u *Logcat* konzolu, koristi se klasa `Log`. Ovo je korisno za praćenje događaja i grešaka tijekom razvoja aplikacije.
Primjer ispisivanja poruke u *Logcat* kada se gumb klikne:

```java
import android.util.Log;
...
myButton.setOnClickListener(v -> {
    Log.d("MainActivity", "Gumb je kliknut!");
});
```

> Logcat se nalazi u donjem dijelu Android Studija, a može se otvoriti putem izbornika: `View` -> `Tool Windows` -> `Logcat`.

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Logcat.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Logcat ikona</i></p>
</div>

Postoje različite razine logiranja:
- `Log.v()` - Verbose
- `Log.d()` - Debug
- `Log.i()` - Info
- `Log.w()` - Warning
- `Log.e()` - Error

Primjer korištenja različitih razina logiranja:

```java
Log.v("MainActivity", "Ovo je verbose poruka");
Log.d("MainActivity", "Ovo je debug poruka");
Log.i("MainActivity", "Ovo je info poruka");
Log.w("MainActivity", "Ovo je warning poruka");
Log.e("MainActivity", "Ovo je error poruka");
```

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Logs.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Logcat: Razine logiranja</i></p>
</div>

### Toast poruke

Toast poruke su kratke obavijesti koje se pojavljuju na ekranu kako bi informirale korisnika o nekoj radnji ili događaju. One su korisne za pružanje povratnih informacija bez ometanja korisničkog iskustva.

Za prikazivanje Toast poruke, koristi se metoda `Toast.makeText()`, koja prima tri argumenta:
1. **Kontekst** - obično se koristi `this` ili `getApplicationContext()`.
2. **Tekst poruke** - niz znakova koji predstavlja poruku koju želite prikazati.
3. **Trajanje** - može biti `Toast.LENGTH_SHORT` ili `Toast.LENGTH_LONG`, ovisno o tome koliko dugo želite da poruka ostane vidljiva.

Evo primjera kako prikazati Toast poruku kada se gumb klikne:

```java
myButton.setOnClickListener(v -> {
    Toast.makeText(MainActivity.this, "Gumb je kliknut!", Toast.LENGTH_SHORT).show();
});
```

> Potrebno je uvesti klasu `import android.widget.Toast;` za prikazivanje Toast poruka.

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/ButtonInteraction.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Toast</i></p>
</div>

<div class="page"></div>

## Druge metode elementa

Osim `setOnClickListener()`, postoje i druge metode za interakciju s UI elementima, ovisno o njihovoj vrsti. Na primjer:
- **EditText**:
  - `getText()` - dohvaća uneseni tekst
  - `setText(String text)` - postavlja tekst u polje
- **TextView**:
  - `setText(String text)` - postavlja tekst u prikaz
- **Button**:
  - `setEnabled(boolean enabled)` - omogućuje ili onemogućuje Gumb
- **CheckBox**:
  - `isChecked()` - provjerava je li označeno
  - `setChecked(boolean checked)` - postavlja stanje označenosti

Primjer korištenja `EditText` i `TextView`:

```java
Button myButton = findViewById(R.id.my_button);
EditText inputField = findViewById(R.id.input_field);
TextView displayText = findViewById(R.id.display_text);

myButton.setOnClickListener(v -> {
    String userInput = inputField.getText().toString();
    displayText.setText(userInput);
});
```

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Pozdrav.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>getText() & setText() metode</i></p>
</div>

> Potrebno je uvesti klase `import android.widget.EditText;` i `import android.widget.TextView;` za rad s tim elementima. 

<div class="page"></div>

Potrebno je obratiti pažnju na konverziju tipova podataka prilikom dohvaćanja unosa iz `EditText`, jer se tekst dohvaća kao `String`. Ako je potreban broj, potrebno je izvršiti odgovarajuću konverziju, npr. `Integer.parseInt()` za cijele brojeve.

Primjer konverzije unosa iz `EditText` u `int`:

```java
EditText numberInput = findViewById(R.id.number_input);
myButton.setOnClickListener(v -> {
    int number = Integer.parseInt(numberInput.getText().toString());
    // Daljnja obrada broja
});
```

U slučaju da korisnik unese neispravan broj ili ostavi polje prazno, može doći do iznimke `NumberFormatException`. Stoga je preporučljivo dodati provjeru unosa prije konverzije.

Primjer provjere unosa:

```java
myButton.setOnClickListener(v -> {
    String inputText = numberInput.getText().toString();
    if (!inputText.isEmpty()) {
        try {
            int number = Integer.parseInt(inputText);
            // Daljnja obrada broja
        } catch (NumberFormatException e) {
            Toast.makeText(MainActivity.this, "Unesite ispravan broj!", Toast.LENGTH_SHORT).show();
        }
    } else {
        Toast.makeText(MainActivity.this, "Polje ne smije biti prazno!", Toast.LENGTH_SHORT).show();
    }
});
```

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Provjera.png"  width="300px" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>NumberFormatException</i></p>
</div>

<div class="page"></div>

## FoodTracker Zadatak

Potrebno je napraviti jednostavnu aplikaciju za praćenje kalorija unesenih prehrambenih proizvoda.

**1. Model podataka**
Kreirajte novu klasu `FoodItem.java` koja sadrži:
- naziv proizvoda (`String`)
- broj kalorija (`int`)
- konstruktor koji postavlja oba podatka
- metode `getFoodName()` i `getKalorije()`

**2. UI elementi (activity_main.xml)**
U prikaz dodajte:
- tekstualni unos za naziv (`EditText`)
- numerički unos za kalorije (`EditText`)
- dva gumba: “Dodaj stavku” i “Resetiraj”
- `TextView` za prikaz *Ukupno kalorija: 0*
- `TextView` za prikaz liste ili poruke *Prazna lista...*

**3. Klasa FoodTracker**
Napravite novu klasu `FoodTracker.java` sa sljedećim funkcionalnostima:
- lista `List<FoodItem>`
- metoda `addFoodItem()` za dodavanje stavke (*uz prikaz Toast poruke*)
- metoda `getTotalCalories()` za izračun ukupnih kalorija
- metoda `getFoodItems()` za dohvat liste
- metoda `clearAll()` za brisanje svih unosa

**4. Spajanje UI-a i logike (MainActivity.java)**
- kreirajte objekt `FoodTracker`
- dohvatite reference svih UI elemenata pomoću `findViewById()`
- na klik gumba *Dodaj*:
  - pročitajte unos
  - stvorite novi `FoodItem`
  - dodajte ga u `FoodTracker`
  - osvježite prikaz ukupnih kalorija
  - ispišite listu svih stavki
- na klik gumba *Resetiraj*:
  - obrišite sve stavke
  - postavite ukupne kalorije na 0
  - ispraznite prikaz liste

<div class="page"></div>

### Primjer rješenja

Napraviti ćemo aplikaciju za praćenje kalorija. Prvo ćemo kreirati novu klasu `FoodItem.java`:

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/NewJavaClass.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Nova Java klasa</i></p>
</div>

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/JavaClassName.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Naziv nove klase</i></p>
</div>

<div class="page"></div>

Zatim ćemo dodati sljedeći kôd u klasu:

```java
public class FoodItem {

    private String FoodName;
    private int Kalorije;

    FoodItem(String foodName, int kalorije) {
        this.FoodName = foodName;
        this.Kalorije = kalorije;
    }

    public String getFoodName() {
        return this.FoodName;
    }

    public int getKalorije() {
        return this.Kalorije;
    }

}
```

Klasa `FoodItem` predstavlja model podataka za prehrambeni proizvod:
  - **Atributi:**
    - `name` - naziv prehrambenog proizvoda (tipa `String`)
    - `calories` - broj kalorija (tipa `int`)
  - **Konstruktor:**
    - Prima naziv i broj kalorija te inicijalizira oba atributa
    - Atributi su označeni kao `final`, što znači da se mogu postaviti samo jednom - prilikom stvaranja objekta
  - **Metode:**
    - `getName()` vraća naziv proizvoda
    - `getCalories()` vraća broj kalorija

> Ova klasa je **nepromjenjiva (*immutable*)** jer nakon stvaranja objekta njegovi podaci se više ne mogu mijenjati.

Zatim ćemo u `activity_main.xml` dodati dva polja za unos:
  - polje za textualni input - `Plain Text` `<EditText>` element
  - polje za brojčani input - `Number` `<EditText>` element

Dodat ćemo dva dugma `<Button>` elementa:
  - jedno s nazivom "Dodaj stavku"
  - drugo s nazivom "Resetiraj"

Dodati text `<TextView>` elemente "*Ukupno kalorija: 0*" i "*Prazna lista...*".

<div class="page"></div>

Tako da izgleda ovako:

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/UI.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Izgled</i></p>
</div>

<div class="page"></div>

Zatim ćemo napraviti novu klasu `FoodTracker.java` i dodati sljedeći kôd:

```java
import java.util.ArrayList;
import java.util.List;

public class FoodTracker {
    private List<FoodItem> foodItems = new ArrayList<>();

    public void addFoodItem(FoodItem foodItem, Context context) {
        foodItems.add(foodItem);
        Toast.makeText(context, ("Stavka " + foodItem.getFoodName() + " uspješno dodana"), Toast.LENGTH_SHORT).show();
    }

    public int getTotalCalories() {
        int totalCalories = 0;

        for (FoodItem foodItem : foodItems) {
            totalCalories += foodItem.getKalorije();
        }
        return totalCalories;
    }

    public List<FoodItem> getFoodItems() {
        return foodItems;
    }

    public void clearAll() {
        foodItems.clear();
    }

}
```

Klasa `FoodTracker` služi za praćenje unosa hrane i zbrajanje ukupnog broja kalorija.
- **Atribut:**
  - `foodItems` - lista objekata tipa `FoodItem`, u kojoj se pohranjuju svi dodani prehrambeni proizvodi
- **Metode:**
  - `addFood(String name, int calories)` - dodaje novi prehrambeni proizvod u listu, stvarajući novi objekt klase `FoodItem`
  - `getTotalCalories()` - prolazi kroz cijelu listu i zbraja kalorije svih proizvoda; vraća ukupni broj kalorija
  - `getFoodItems()` - vraća cijelu listu prehrambenih proizvoda
  - `clearAll()` - briše sve proizvode iz liste (prazni praćenje hrane)

<div class="page"></div>

U `MainActivity.java` dodat ćemo objekt **FoodTracker**:

```java
public class MainActivity extends AppCompatActivity {
  private FoodTracker foodTracker;
  ...
}
```

Sada kada imamo klase trebamo dohvatiti *reference* na elemente kosriteći njihov **ID** atribut. Pa ćemo dodati sljedeće nakon `setContentView()` funkcije:
```java
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

...
setContentView(R.layout.activity_main);

foodTracker = new FoodTracker();

TextView textUkupno = findViewById(R.id.ukupno);
TextView textLista = findViewById(R.id.lista);
EditText inputNaziv = findViewById(R.id.inputNaziv);
EditText inputKalorije = findViewById(R.id.inputKalorije);
Button dodaj = findViewById(R.id.btnDodaj);
Button resetiraj = findViewById(R.id.btnResetiraj);
...
```

<div class="page"></div>

Nakon čega možemo dodati interakciju s elementima:

```java
dodaj.setOnClickListener(view -> {
    String naziv = inputNaziv.getText().toString();
    int kalorije = Integer.parseInt(inputKalorije.getText().toString());
    FoodItem noviItem = new FoodItem(naziv, kalorije);
    foodTracker.addFoodItem(noviItem,this);

    int ukupnoKalorija = foodTracker.getTotalCalories();
    textUkupno.setText("Ukupno kalorija: " + ukupnoKalorija);

    String stavke = "";
    for (FoodItem item : foodTracker.getFoodItems()) {
        stavke += item.getFoodName() + " - " +
                  item.getKalorije() + " kalorija\n";
    }
    textLista.setText(stavke);

});

resetiraj.setOnClickListener(view -> {
    foodTracker.clearAll();
    textUkupno.setText("Ukupno kalorija: 0");
    textLista.setText("");
});
```

<div class="page"></div>

<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/Done.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Primjer</i></p>
</div>

</div>