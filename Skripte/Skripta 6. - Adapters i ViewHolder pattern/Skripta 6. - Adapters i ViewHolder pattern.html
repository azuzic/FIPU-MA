<!DOCTYPE html>
<html>
	<head>
		<title>Skripta 6. - Adapters i ViewHolder pattern.md</title>
		<meta
			http-equiv="Content-type"
			content="text/html;charset=UTF-8" />
		<link
			rel="preconnect"
			href="https://fonts.googleapis.com" />
		<link
			rel="preconnect"
			href="https://fonts.gstatic.com"
			crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
			rel="stylesheet" />
		<style>
			/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
			/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
			:not(code *) {
				font-family: "Poppins", sans-serif;
			}
            html {
                display: flex;
                justify-content: center;
            }
			body {
				font-family: var(
					--vscode-markdown-font-family,
					-apple-system,
					BlinkMacSystemFont,
					"Segoe WPC",
					"Segoe UI",
					"Ubuntu",
					"Droid Sans",
					sans-serif
				);
				font-size: var(--vscode-markdown-font-size, 14px);
				line-height: var(--vscode-markdown-line-height, 22px);
				word-wrap: break-word;
				color: #3b3b3b;
                position: absolute;
                display: flex;
                justify-content: center;
                width: full;
			}
			.body {
                max-width: 1012px;
			}

			#code-csp-warning {
				position: fixed;
				top: 0;
				right: 0;
				color: white;
				margin: 16px;
				text-align: center;
				font-size: 12px;
				font-family: sans-serif;
				background-color: #444444;
				cursor: pointer;
				padding: 6px;
				box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
			}

			#code-csp-warning:hover {
				text-decoration: none;
				background-color: #007acc;
				box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.25);
			}

			body.scrollBeyondLastLine {
				margin-bottom: calc(100vh - 22px);
			}

			body.showEditorSelection .code-line {
				position: relative;
			}

			body.showEditorSelection .code-active-line:before,
			body.showEditorSelection .code-line:hover:before {
				content: "";
				display: block;
				position: absolute;
				top: 0;
				left: -12px;
				height: 100%;
			}

			body.showEditorSelection li.code-active-line:before,
			body.showEditorSelection li.code-line:hover:before {
				left: -30px;
			}

			.vscode-light.showEditorSelection .code-active-line:before {
				border-left: 3px solid rgba(0, 0, 0, 0.15);
			}

			.vscode-light.showEditorSelection .code-line:hover:before {
				border-left: 3px solid rgba(0, 0, 0, 0.4);
			}

			.vscode-light.showEditorSelection
				.code-line
				.code-line:hover:before {
				border-left: none;
			}

			.vscode-dark.showEditorSelection .code-active-line:before {
				border-left: 3px solid rgba(255, 255, 255, 0.4);
			}

			.vscode-dark.showEditorSelection .code-line:hover:before {
				border-left: 3px solid rgba(255, 255, 255, 0.6);
			}

			.vscode-dark.showEditorSelection
				.code-line
				.code-line:hover:before {
				border-left: none;
			}

			.vscode-high-contrast.showEditorSelection .code-active-line:before {
				border-left: 3px solid rgba(255, 160, 0, 0.7);
			}

			.vscode-high-contrast.showEditorSelection .code-line:hover:before {
				border-left: 3px solid rgba(255, 160, 0, 1);
			}

			.vscode-high-contrast.showEditorSelection
				.code-line
				.code-line:hover:before {
				border-left: none;
			}

			img {
				max-width: 100%;
				max-height: 100%;
				border-radius: 8px;
				filter: drop-shadow(-0 2px 2px rgba(0, 0, 0, 0.07));
			}

			a {
				text-decoration: none;
			}

			a:hover {
				text-decoration: underline;
			}

			a:focus,
			input:focus,
			select:focus,
			textarea:focus {
				outline: 1px solid -webkit-focus-ring-color;
				outline-offset: -1px;
			}

			hr {
				border: 0;
				height: 2px;
				border-bottom: 2px solid;
			}

			h1 {
				padding-bottom: 0.3em;
				line-height: 1.2;
				border-bottom-width: 1px;
				border-bottom-style: solid;
			}

			h1,
			h2,
			h3 {
				font-weight: normal;
			}

			table {
				border-collapse: collapse;
			}

			table > thead > tr > th {
				text-align: left;
				border-bottom: 1px solid;
			}

			table > thead > tr > th,
			table > thead > tr > td,
			table > tbody > tr > th,
			table > tbody > tr > td {
				padding: 5px 10px;
			}

			table > tbody > tr + tr > td {
				border-top: 1px solid;
			}

			td > code {
                word-break: break-all;
            }

			blockquote {
				margin: 0 7px 0 5px;
				padding: 0 16px 0 10px;
				border-left-width: 5px;
				border-left-style: solid;
			}

			code {
				font-family: Menlo, Monaco, Consolas, "Droid Sans Mono",
					"Courier New", monospace, "Droid Sans Fallback";
				font-size: 1em;
				line-height: 1.357em;
                line-break: anywhere;
			}

			body.wordWrap pre {
				white-space: pre-wrap;
			}

			pre:not(.hljs),
			pre.hljs code > div {
				padding: 16px;
				border-radius: 3px;
				overflow: auto;
			}

			pre code {
				color: var(--vscode-editor-foreground);
				tab-size: 4;
			}

			/** Theming */

			.vscode-light pre {
				background-color: rgba(220, 220, 220, 0.4);
			}

			.vscode-dark pre {
				background-color: rgba(10, 10, 10, 0.4);
			}

			.vscode-high-contrast pre {
				background-color: rgb(0, 0, 0);
			}

			.vscode-high-contrast h1 {
				border-color: rgb(0, 0, 0);
			}

			.vscode-light table > thead > tr > th {
				border-color: rgba(0, 0, 0, 0.69);
			}

			.vscode-dark table > thead > tr > th {
				border-color: rgba(255, 255, 255, 0.69);
			}

			.vscode-light h1,
			.vscode-light hr,
			.vscode-light table > tbody > tr + tr > td {
				border-color: rgba(0, 0, 0, 0.18);
			}

			.vscode-dark h1,
			.vscode-dark hr,
			.vscode-dark table > tbody > tr + tr > td {
				border-color: rgba(255, 255, 255, 0.18);
			}
		</style>

		<style>
			/*

Visual Studio-like style based on original C# coloring by Jason Diamond <jason@diamond.name>

*/
			.hljs {
				background: white;
				color: black;
			}

			.hljs-comment,
			.hljs-quote,
			.hljs-variable {
				color: #008000;
			}

			.hljs-keyword,
			.hljs-selector-tag,
			.hljs-built_in,
			.hljs-name,
			.hljs-tag {
				color: #00f;
			}

			.hljs-string,
			.hljs-title,
			.hljs-section,
			.hljs-attribute,
			.hljs-literal,
			.hljs-template-tag,
			.hljs-template-variable,
			.hljs-type,
			.hljs-addition {
				color: #a31515;
			}

			.hljs-deletion,
			.hljs-selector-attr,
			.hljs-selector-pseudo,
			.hljs-meta {
				color: #2b91af;
			}

			.hljs-doctag {
				color: #808080;
			}

			.hljs-attr {
				color: #f00;
			}

			.hljs-symbol,
			.hljs-bullet,
			.hljs-link {
				color: #00b0e8;
			}

			.hljs-emphasis {
				font-style: italic;
			}

			.hljs-strong {
				font-weight: bold;
			}
		</style>

		<style>
			/*
 * Markdown PDF CSS
 */

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC",
					"Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
			}

			pre {
				background-color: #f8f8f8;
				border: 1px solid #cccccc;
				border-radius: 3px;
				overflow-x: auto;
				white-space: pre-wrap;
				overflow-wrap: break-word;
			}

			pre:not(.hljs) {
				padding: 23px;
				line-height: 19px;
			}

			blockquote {
				background: rgba(127, 127, 127, 0.1);
				border-color: rgba(0, 122, 204, 0.5);
			}

			.emoji {
				height: 1.4em;
			}

			code {
				font-size: 14px;
				line-height: 19px;
			}

			/* for inline code */
			:not(pre):not(.hljs) > code {
				color: #3b3b3b; /* Change the old color so it seems less like an error */
				font-size: inherit;
				background: #e0e0e0;
				border-radius: 4px;
				padding: 1px 2px;
				margin: -1px -2px;
			}

			/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
			.page {
				page-break-after: always;
			}
		</style>

		<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
	</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<div>
<h1 id="mobilne-aplikacije">Mobilne Aplikacije</h1>
<p><strong>Nositelj</strong>: doc. dr. sc. Nikola Tanković<br>
<strong>Izvođač</strong>: dr. sc. Robert Šajina<br>
<strong>Asistent</strong>: mag. inf. Alesandro Žužić</p>
<p><strong>Ustanova</strong>: Sveučilište Jurja Dobrile u Puli, Fakultet informatike u Puli</p>
<p style="float: clear; display: flex; gap: 8px; align-items: center;" class="font-brioni text-sm whitespace-nowrap">
    <img src="../Logo/fipu_logo.svg" style="height: 96px; box-shadow: none !important;" class="mr-4"></img>
    Fakultet informatike u Puli
</p>
<h1 id="6---adapters-i-viewholder-pattern">[6] - Adapters i ViewHolder pattern</h1>
<p><strong>Posljednje ažurirano:</strong> 11. prosinca 2025.</p>
<h2 id="sadr%C5%BEaj">Sadržaj</h2>
<!-- TOC -->
<ul>
<li><a href="#sadr%C5%BEaj">Sadržaj</a></li>
<li><a href="#adapteri">Adapteri</a></li>
<li><a href="#viewholder-pattern">ViewHolder pattern</a></li>
<li><a href="#recyclerview">RecyclerView</a>
<ul>
<li><a href="#primjer-kori%C5%A1tenja-recyclerview">Primjer korištenja RecyclerView</a></li>
<li><a href="#primjer-ko%C5%A1arica">Primjer Košarica</a></li>
<li><a href="#a%C5%BEuriranje-recyclerview">Ažuriranje RecyclerView</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<div class="page"></div>
<h2 id="adapteri">Adapteri</h2>
<p>Adapter u Androidu predstavlja ključnu komponentu koja povezuje izvor podataka i njihov vizualni prikaz u korisničkom sučelju. Koristi se svaki put kada trebamo prikazati kolekciju elemenata, poput lista, nizova ili objekata, u obliku koji se može skrolati ili dinamički ažurirati.</p>
<p><strong>Adapter</strong> ima nekoliko osnovnih zadataka:</p>
<ul>
<li>obavještava <strong>RecyclerView</strong> koliko elemenata treba prikazati</li>
<li>određuje izgled <strong>pojedinog elementa</strong> liste, napuhavanjem layouta (<em>inflating layout</em>)</li>
<li><strong>puni</strong> svaki element konkretnim podacima (<em>tekst, slika, ikona, ...</em>)</li>
</ul>
<p>Drugim riječima, Android bez adaptera ne zna:</p>
<ul>
<li>koliko stavki lista sadrži</li>
<li>kako izgleda pojedina stavka</li>
<li>kako se svaki redak puni sadržajem</li>
</ul>
<p><strong>Adapter</strong> tako preuzima ulogu prevoditelja između &quot;suhih&quot; podataka i stvarnog prikaza na ekranu. Omogućuje odvajanje logike prikaza od logike podataka, što olakšava održavanje, proširivanje i ponovno korištenje koda.</p>
<p><strong>Glavne komponente</strong></p>
<ul>
<li><strong>RecyclerView</strong> – prikazuje listu elemenata</li>
<li><strong>LayoutManager</strong> – definira raspored (<em>vertikalni, horizontalni, mrežni</em>)</li>
<li><strong>Adapter</strong> – povezuje podatke s prikazom, kreira <strong>ViewHolder</strong> i puni elemente</li>
<li><strong>ViewHolder</strong> – čuva reference na UI elemente unutar itema radi bržeg bindanja</li>
<li><strong>ItemDecoration</strong> – dodaje razmake, obrube ili linije između itema</li>
<li><strong>ItemAnimator</strong> – animira dodavanje, brisanje i promjene stavki</li>
</ul>
<blockquote>
<p>Prije se koristio <em>ListView</em>, međutim moderni Android danas preferira <em>RecyclerView</em>, jer <em>ListView</em> ima ograničenja</p>
</blockquote>
<h2 id="viewholder-pattern">ViewHolder pattern</h2>
<p><code>ViewHolder</code> pattern koristi se kako bi <em>RecyclerView</em> radio učinkovitije, posebno kada lista sadrži veliki broj elemenata. Njegova glavna svrha je <strong>izbjegavanje ponovljenih i skupih poziva <code>findViewById</code></strong>, koji bi inače usporavali listu prilikom pomicanja.</p>
<p>Kada se jedan prikaz reciklira, <em>RecyclerView</em> ponovno koristi već postojeći View umjesto da kreira novi. Bez <em>ViewHoldera</em>, svaki put bi se moralo ispočetka tražiti reference na UI elemente unutar itema (<em>npr. TextView, ImageView</em>), što je neefikasno.</p>
<p><em>ViewHolder</em> rješava taj problem tako da <strong>jednom pronađe sve potrebne view elemente i spremi ih u objekte</strong>, pa adapter može direktno pristupiti tim referencama.</p>
<ul>
<li>U <code>onCreateViewHolder()</code> se napuhuje (<em>inflate</em>) layout za jedan item i inicijalno kreira <em>ViewHolder</em> koji čuva sve UI reference</li>
<li>U <code>onBindViewHolder()</code> adapter samo postavlja podatke u te već spremljene view elemente bez dodatnog pretraživanja, što omogućuje brzo i glatko pomicanje</li>
</ul>
<h2 id="recyclerview">RecyclerView</h2>
<p><code>RecyclerView</code> je napredna komponenta za prikaz lista i kolekcija podataka. Dizajniran je tako da radi brzo, učinkovito i fleksibilno, posebno kada radimo s velikim brojem elemenata. Ključni princip je <strong>recikliranje prikaza</strong> – umjesto da za svaki element stvara novi View, <em>RecyclerView</em> ponovno koristi već postojeće prikaze koji više nisu na ekranu.</p>
<blockquote>
<p><em>RecyclerView</em> je dio AndroidX biblioteke, stoga ga je potrebno dodati u projekt putem <code>build.gradle</code> datoteke prije korištenja ili ga preuzeti unutar <em>Palette</em> GUI-a kod XML pregleda.</p>
</blockquote>
<p>Za razliku od starijeg <code>ListView</code>, <code>RecyclerView</code> omogućuje:</p>
<ul>
<li>potpunu kontrolu nad rasporedom elemenata putem različitih <code>LayoutManagera</code></li>
<li>dodavanje ukrasnih elemenata i razmaka preko <code>ItemDecoration</code></li>
<li>animacije pri dodavanju, uklanjanju i promjenama elemenata</li>
<li>lakše korištenje <em>ViewHolder</em> patterna koji je obvezan i poboljšava performanse</li>
</ul>
<h3 id="primjer-kori%C5%A1tenja-recyclerview">Primjer korištenja RecyclerView</h3>
<p>Dodat ćemo <strong>RecyclerView</strong> u <code>activity_main.xml</code> iz <em>Palette</em> GUI-a:</p>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">xmlns:app</span>=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>
    <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/main"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">tools:context</span>=<span class="hljs-string">".MainActivity"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">androidx.recyclerview.widget.RecyclerView</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/myRecyclerView"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"0dp"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"0dp"</span>
        <span class="hljs-attr">app:layoutManager</span>=<span class="hljs-string">"androidx.recyclerview.widget.LinearLayoutManager"</span>
        <span class="hljs-attr">android:layout_marginStart</span>=<span class="hljs-string">"32dp"</span>
        <span class="hljs-attr">android:layout_marginTop</span>=<span class="hljs-string">"32dp"</span>
        <span class="hljs-attr">android:layout_marginEnd</span>=<span class="hljs-string">"32dp"</span>
        <span class="hljs-attr">android:layout_marginBottom</span>=<span class="hljs-string">"32dp"</span>
        <span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"parent"</span>
        <span class="hljs-attr">app:layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"parent"</span>
        <span class="hljs-attr">app:layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span>
        <span class="hljs-attr">app:layout_constraintTop_toTopOf</span>=<span class="hljs-string">"parent"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span>
</div></code></pre>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/RecyclerView.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Dodavanje RecyclerView</i></p>
</div>
<ul>
<li>Potrebno je postaviti <code>app:layoutManager</code>, inače stavke neće biti prikazani jer <em>RecyclerView</em> ne zna kako rasporediti elemente</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">androidx.recyclerview.widget.RecyclerView</span>
    <span class="hljs-attr">app:layoutManager</span>=<span class="hljs-string">"androidx.recyclerview.widget.LinearLayoutManager"</span>
    <span class="hljs-attr">...</span>
/&gt;</span>
</div></code></pre>
<p>Zatim ćemo napraviti jedan item (<code>list_item.xml</code>) u <em>layout</em> direktoriju:</p>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/textView"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"0dp"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</div></code></pre>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/list_item.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>list_item.xml</i></p>
</div>
<ul>
<li>Potrebno je postaviti <code>android:layout_height</code> na <code>wrap_content</code>, inače će biti prikazan samo jedna stavka jer će svi itemi imati visinu jednaku visini roditeljskog RecyclerView-a</li>
</ul>
<p>Sada možemo napraviti <strong>Adapter</strong> klasu <code>MyAdapter.java</code>:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">Adapter</span>&lt;<span class="hljs-title">MyAdapter</span>.<span class="hljs-title">MyViewHolder</span>&gt; </span>{

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; items;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyAdapter</span><span class="hljs-params">(List&lt;String&gt; items)</span> </span>{
        <span class="hljs-keyword">this</span>.items = items;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewHolder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">ViewHolder</span> </span>{
        TextView text;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyViewHolder</span><span class="hljs-params">(@NonNull View itemView)</span> </span>{
            <span class="hljs-keyword">super</span>(itemView);
            text = itemView.findViewById(R.id.textView);
        }
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bind</span><span class="hljs-params">(String item)</span> </span>{
            text.setText(item);
        }
    }

    <span class="hljs-meta">@NonNull</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MyViewHolder <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(@NonNull ViewGroup parent, <span class="hljs-keyword">int</span> viewType)</span> </span>{
        View view = LayoutInflater.from(parent.getContext())
                .inflate(R.layout.list_item, parent, <span class="hljs-keyword">false</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyViewHolder(view);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(@NonNull MyViewHolder holder, <span class="hljs-keyword">int</span> position)</span> </span>{
        String item =items.get(position);
        holder.bind(item);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getItemCount</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> items.size();
    }
}
</div></code></pre>
<p>Korištenje u aktivnosti <code>MainActivity.java</code>:</p>
<pre class="hljs"><code><div>RecyclerView recycler = findViewById(R.id.myRecyclerView);
MyAdapter adapter = <span class="hljs-keyword">new</span> MyAdapter(
    Arrays.asList(<span class="hljs-string">"Item 1"</span>, <span class="hljs-string">"Item 2"</span>, <span class="hljs-string">"Item 3"</span>, <span class="hljs-string">"Item 4"</span>)
);
recycler.setAdapter(adapter);
</div></code></pre>
<ul>
<li>Pronalazimo RecyclerView u layoutu</li>
<li>Kreiramo instancu <code>MyAdapter</code> s listom stavki</li>
<li>Postavljamo adapter na RecyclerView</li>
</ul>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/RecyclerViewPrimjer.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>RecyclerView primjer</i></p>
</div>
<p><code>MyAdapter</code> klasa je velika tako da ćemo je razdijeliti u sekcije i pobjasniti. Prvo kreiramo klasu adaptera koja nasljeđuje <code>RecyclerView.Adapter</code> i koristi vlastiti <code>ViewHolder</code>. U adapteru držimo listu podataka.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">Adapter</span>&lt;<span class="hljs-title">MyAdapter</span>.<span class="hljs-title">MyViewHolder</span>&gt; </span>{

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; items;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyAdapter</span><span class="hljs-params">(List&lt;String&gt; items)</span> </span>{
        <span class="hljs-keyword">this</span>.items = items;
    }
    ...
</div></code></pre>
<ul>
<li><code>items</code> sadrži sve stavke koje želimo prikazati</li>
<li>Konstruktor <code>MyAdapter</code> prima listu stavki koju sprema u polje</li>
</ul>
<p>Nakon toga definiramo <strong>ViewHolder</strong> <code>MyViewHolder</code> koji drži reference na UI elemente i može ih popuniti podacima.</p>
<pre class="hljs"><code><div>    ...
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewHolder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">ViewHolder</span> </span>{
        TextView text;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyViewHolder</span><span class="hljs-params">(@NonNull View itemView)</span> </span>{
            <span class="hljs-keyword">super</span>(itemView);
            text = itemView.findViewById(R.id.itemText);
        }

        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bind</span><span class="hljs-params">(String item)</span> </span>{
            text.setText(item);
        }
    }
    ...
</div></code></pre>
<ul>
<li>Konstruktor <em>ViewHoldera</em> pronalazi <code>TextView</code> u layoutu itema i sprema referencu u polje <code>text</code></li>
<li>Metoda <code>bind</code> postavlja tekst u <code>TextView</code> kada se pozove iz adaptera</li>
</ul>
<p>Adapter <strong>mora kreirati</strong> <em>ViewHolder</em> kada <em>RecyclerView</em> zatraži novi element.</p>
<pre class="hljs"><code><div>    <span class="hljs-meta">@NonNull</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MyViewHolder <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(@NonNull ViewGroup parent, <span class="hljs-keyword">int</span> viewType)</span> </span>{
        View view = LayoutInflater.from(parent.getContext())
                .inflate(R.layout.list_item, parent, <span class="hljs-keyword">false</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyViewHolder(view);
    }
</div></code></pre>
<ol>
<li><code>LayoutInflater.from(parent.getContext())</code> – dobiva inflater iz konteksta roditeljskog ViewGroup-a
<ul>
<li><code>parent</code> je RecyclerView koji sadrži iteme</li>
<li><code>getContext()</code> vraća kontekst aplikacije ili aktivnosti u kojoj se RecyclerView nalazi</li>
<li>Inflater se koristi za napuhivanje (<em>učitavanje</em>) XML layout datoteka u stvarne View objekte u memoriji</li>
</ul>
</li>
<li><code>.inflate(R.layout.list_item, parent, false)</code> – napuhuje (učitava) XML layout datoteku <code>list_item.xml</code> u View objekat
<ul>
<li><code>R.layout.list_item</code> je referenca na XML datoteku koja definira izgled jednog itema u listi</li>
<li><code>parent</code> je roditeljski ViewGroup (RecyclerView) koji će sadržavati ovaj item</li>
<li><code>false</code> znači da se novi View neće odmah dodati u roditelja</li>
</ul>
</li>
<li><code>return new MyViewHolder(view)</code> – kreira i vraća novi ViewHolder s referencama na UI elemente iz napuhanog layout-a
<ul>
<li><code>view</code> je root View napuhanog layouta koji se prosljeđuje konstruktoru ViewHolder-a</li>
</ul>
</li>
</ol>
<ul>
<li>Ova metoda se poziva samo kada je potreban novi ViewHolder (<em>npr. pri inicijalnom prikazu ili kada nema recikliranih ViewHolder-a dostupnih</em>)</li>
</ul>
<p>Kada <em>RecyclerView</em> treba prikazati podatke u određenom položaju, poziva se <code>onBindViewHolder()</code>:</p>
<pre class="hljs"><code><div>    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(@NonNull MyViewHolder holder, <span class="hljs-keyword">int</span> position)</span> </span>{
        String item = items.get(position);
        holder.bind(item);
    }
</div></code></pre>
<ul>
<li>Prima <em>ViewHolder</em> i poziciju stavke koja se treba prikazati</li>
<li>Dohvaća podatke iz liste <code>items</code> na danoj poziciji</li>
<li>Poziva <code>bind()</code> metodu <em>ViewHoldera</em> kako bi postavio podatke</li>
</ul>
<p>Na kraju postavljamo <code>getItemCount()</code> metodu:</p>
<pre class="hljs"><code><div>    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getItemCount</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> items.size();
    }
}
</div></code></pre>
<ul>
<li>Vraća ukupan broj stavki u adapteru</li>
<li>Bez ove metode <em>RecyclerView</em> ne zna koliko elemenata treba prikazati</li>
<li>Služi za određivanje veličine liste koja će biti prikazana (<em>npr. paginacija</em>)</li>
</ul>
<h3 id="primjer-ko%C5%A1arica">Primjer Košarica</h3>
<p>Kao primjer složenijeg adaptera, napravit ćemo aplikaciju za košaricu u trgovini. Košarica će sadržavati listu proizvoda s nazivom, cijenom i količinom. Također ćemo imati mogućnost povećanja i smanjenja količine proizvoda, dodavanje i uklanjanje proizvoda te izračun ukupne cijene svih proizvoda.</p>
<p>Napravit ćemo klasu <code>Proizvod</code>, koja predstavlja jedan proizvod u košarici. Ima sljedeća svojstva i metode:</p>
<ul>
<li>Naziv proizvoda (<code>naziv</code>)</li>
<li>Cijena po jedinici (<code>cijena</code>)</li>
<li>Količina proizvoda u košarici (<code>kolicina</code>)</li>
<li><code>povecajKolicinu(int kolicina)</code>
<ul>
<li>Povećanje količine ne smije prijeći 100</li>
</ul>
</li>
<li><code>smanjiKolicinu(int kolicina)</code>
<ul>
<li>Smanjenje količine ne smije ići ispod 0</li>
</ul>
</li>
<li><code>izracunajUkupnuCijenu()</code>
<ul>
<li>Metoda vraća ukupnu cijenu kao <code>double</code></li>
<li>Zaokružuje rezultat na dvije decimale</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Proizvod</span> </span>{
    <span class="hljs-keyword">private</span> String naziv;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> cijena;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> kolicina;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Proizvod</span><span class="hljs-params">(String naziv, <span class="hljs-keyword">double</span> cijena, <span class="hljs-keyword">int</span> kolicina)</span> </span>{
        <span class="hljs-keyword">this</span>.naziv = naziv;
        <span class="hljs-keyword">this</span>.cijena = cijena;
        <span class="hljs-keyword">this</span>.kolicina = kolicina;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getNaziv</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> naziv; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getCijena</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> cijena; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getKolicina</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> kolicina; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">povecajKolicinu</span><span class="hljs-params">(<span class="hljs-keyword">int</span> kolicina)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.kolicina + kolicina &lt; <span class="hljs-number">100</span>) <span class="hljs-keyword">this</span>.kolicina += kolicina;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">smanjiKolicinu</span><span class="hljs-params">(<span class="hljs-keyword">int</span> kolicina)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.kolicina - kolicina &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>.kolicina -= kolicina;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">izracunajUkupnuCijenu</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> cijena * kolicina; }
}
</div></code></pre>
<p>Zatim ćemo napraviti klasu <code>Kosarica</code>, koja predstavlja košaricu s proizvodima. Ima sljedeća svojstva i metode:</p>
<ul>
<li>Lista proizvoda u košarici (<code>proizvodi</code>)</li>
<li><code>getProizvodi()</code>
<ul>
<li>Vraća listu proizvoda</li>
</ul>
</li>
<li><code>dodajProizvod(Proizvod proizvod)</code>
<ul>
<li>Dodaje proizvod u košaricu</li>
</ul>
</li>
<li><code>ukloniProizvod(Proizvod proizvod)</code>
<ul>
<li>Uklanja proizvod iz košarice</li>
</ul>
</li>
<li><code>ukupanIznos()</code>
<ul>
<li>Vraća ukupan iznos svih proizvoda u košarici kao <code>double</code></li>
<li>Zaokružuje rezultat na dvije decimale</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Kosarica</span> </span>{
    <span class="hljs-keyword">private</span> List&lt;Proizvod&gt; proizvodi = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Proizvod&gt; <span class="hljs-title">getProizvodi</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> proizvodi; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dodajProizvod</span><span class="hljs-params">(Proizvod proizvod)</span></span>{ proizvodi.add(proizvod); }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ukloniProizvod</span><span class="hljs-params">(Proizvod proizvod)</span></span>{ proizvodi.remove(proizvod); }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">ukupanIznos</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">double</span> ukupanIznos = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (Proizvod proizvod : proizvodi) 
            ukupanIznos += proizvod.izracunajUkupnuCijenu();
        <span class="hljs-keyword">return</span> Math.round(ukupanIznos * <span class="hljs-number">100.0</span>) / <span class="hljs-number">100.0</span>;
    }
}
</div></code></pre>
<p>Napravit ćemo <code>MainActivity.java</code> gdje ćemo koristiti <code>Kosarica</code> i dodati nekoliko proizvoda.
U <code>MainActivity.java</code> ćemo napraviti instancu <code>Kosarica</code> i dodati nekoliko proizvoda:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">private</span> Kosarica kosarica;
...
<span class="hljs-meta">@Override</span> 
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
    ...
    kosarica = <span class="hljs-keyword">new</span> Kosarica();

    Proizvod jabuka = <span class="hljs-keyword">new</span> Proizvod(<span class="hljs-string">"Jabuka"</span>, <span class="hljs-number">0.28f</span>, <span class="hljs-number">2</span>);
    Proizvod banana = <span class="hljs-keyword">new</span> Proizvod(<span class="hljs-string">"Banana"</span>, <span class="hljs-number">0.16f</span>, <span class="hljs-number">5</span>);
    Proizvod breskva = <span class="hljs-keyword">new</span> Proizvod(<span class="hljs-string">"Breskva"</span>, <span class="hljs-number">0.42f</span>, <span class="hljs-number">1</span>);

    kosarica.dodajProizvod(jabuka);
    kosarica.dodajProizvod(banana);
    kosarica.dodajProizvod(breskva);
    ...
}
</div></code></pre>
<p><code>activity_main.xml</code> će sadržavati <code>RecyclerView</code> za prikaz proizvoda, <code>TextView</code> za prikaz ukupnog iznosa. EditText i Button-e za dodavanje novih proizvoda.</p>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/KosaricaActivityMain.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Kosarica - activity_main.xml</i></p>
</div>
<p>Napravit ćemo layout za jedan proizvod u košarici <code>proizvod_item.xml</code> koji će sadržavati naziv proizvoda, cijenu, količinu, gumbe za povećanje i smanjenje količine te gumb za uklanjanje proizvoda iz košarice.</p>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/kosarica_item.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Kosarica - proizvod_item.xml</i></p>
</div>
<p>Sada možemo napraviti <code>KosaricaAdapter.java</code> koji će nasljeđivati <code>RecyclerView.Adapter</code> i koristiti <code>KosaricaViewHolder</code> za prikaz proizvoda u košarici. U adapteru ćemo implementirati logiku za povećanje, smanjenje količine i uklanjanje proizvoda iz košarice.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KosaricaAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">Adapter</span>&lt;<span class="hljs-title">KosaricaAdapter</span>.<span class="hljs-title">ProizvodViewHolder</span>&gt; </span>{

    <span class="hljs-comment">// Referenca na košaricu</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Kosarica kosarica;

    <span class="hljs-comment">// Listener za obavještavanje promjena u košarici</span>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">OnItemsChangedListener</span> </span>{  
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onItemChanged</span><span class="hljs-params">()</span></span>; 
    }

    <span class="hljs-comment">// Referenca na listener &amp; metoda za postavljanje listenera</span>
    <span class="hljs-keyword">private</span> OnItemsChangedListener itemsChangedListener;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setOnItemsChangedListener</span><span class="hljs-params">(OnItemsChangedListener listener)</span> </span>{
        <span class="hljs-keyword">this</span>.itemsChangedListener = listener;
    }

    <span class="hljs-comment">// Konstruktor adaptera prima instancu košarice</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">KosaricaAdapter</span><span class="hljs-params">(Kosarica kosarica)</span> </span>{ 
        KosaricaAdapter.kosarica = kosarica; 
    }
    ...
</div></code></pre>
<p>Definicija <code>ProizvodViewHolder</code> klase unutar <code>KosaricaAdapter</code>:</p>
<pre class="hljs"><code><div>...
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProizvodViewHolder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">ViewHolder</span> </span>{

    <span class="hljs-comment">// UI elementi za prikaz proizvoda</span>
    TextView textNaziv;
    TextView textCijena;
    TextView textKolicina;
    ImageButton buttonAdd;
    ImageButton buttonMinus;
    ImageButton buttonRemove;

    <span class="hljs-comment">// Konstruktor ViewHolder-a</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ProizvodViewHolder</span><span class="hljs-params">(@NonNull View itemView)</span> </span>{
        <span class="hljs-keyword">super</span>(itemView);
        textNaziv = itemView.findViewById(R.id.textNaziv);
        textCijena = itemView.findViewById(R.id.textCijena);
        textKolicina = itemView.findViewById(R.id.textKolicina);
        buttonAdd = itemView.findViewById(R.id.btnAdd);
        buttonMinus = itemView.findViewById(R.id.btnMinus);
        buttonRemove = itemView.findViewById(R.id.btnRemove);
    }

    <span class="hljs-comment">// Metoda za postavljanje podataka i ponašanja gumba UI elemenata</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">postaviProizvod</span><span class="hljs-params">(Proizvod proizvod)</span> </span>{
        <span class="hljs-comment">// Postavljanje podataka u UI elemente</span>
        textNaziv.setText(proizvod.getNaziv());
        textCijena.setText(String.valueOf(proizvod.getCijena()));
        textKolicina.setText(String.valueOf(proizvod.getKolicina()));

        <span class="hljs-comment">// Definiranje ponašanja gumba</span>
        buttonAdd.setOnClickListener(view -&gt; {
            proizvod.povecajKolicinu(<span class="hljs-number">1</span>);
            textKolicina.setText(String.valueOf(proizvod.getKolicina()));
            <span class="hljs-comment">// Obavještavanje listenera o promjeni</span>
            itemsChangedListener.onItemChanged();
        });

        buttonMinus.setOnClickListener(view -&gt; {
            proizvod.smanjiKolicinu(<span class="hljs-number">1</span>);
            textKolicina.setText(String.valueOf(proizvod.getKolicina()));
            <span class="hljs-comment">// Obavještavanje listenera o promjeni</span>
            itemsChangedListener.onItemChanged();
        });

        buttonRemove.setOnClickListener(view -&gt; {
            kosarica.ukloniProizvod(proizvod);
            <span class="hljs-comment">// Obavještavanje listenera o promjeni</span>
            itemsChangedListener.onItemChanged();
            <span class="hljs-comment">// Obavještavanje adaptera o promjeni podataka</span>
            notifyDataSetChanged();
        });
    }
}
...
</div></code></pre>
<ul>
<li><strong><code>notifyDataSetChanged()</code></strong> obavještava adapter da su se podaci promijenili i da treba osvježiti prikaz</li>
</ul>
<p>Metode adaptera za kreiranje i bindanje ViewHolder-a te dobivanje broja stavki:</p>
<pre class="hljs"><code><div>...
<span class="hljs-comment">// Kreiranje ViewHolder-a</span>
<span class="hljs-comment">// napuhavanje layouta, vraćanje ViewHolder-a</span>
<span class="hljs-meta">@NonNull</span> <span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ProizvodViewHolder <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(@NonNull ViewGroup kosarica_recycler, <span class="hljs-keyword">int</span> viewType)</span> </span>{
    View proizvod_item_view = LayoutInflater.from(kosarica_recycler.getContext())
            .inflate(R.layout.proizvod_item, kosarica_recycler, <span class="hljs-keyword">false</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProizvodViewHolder(proizvod_item_view);
}

<span class="hljs-comment">// Bindanje podataka u ViewHolder</span>
<span class="hljs-comment">// postavljanje podataka u UI elemente, definiranje ponašanja gumba</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(@NonNull ProizvodViewHolder proizvodViewHolder, <span class="hljs-keyword">int</span> position)</span> </span>{
    Proizvod proizvod = kosarica.getProizvodi().get(position);
    proizvodViewHolder.postaviProizvod(proizvod);
}

<span class="hljs-comment">// Dobivanje broja stavki u košarici - vraćanje veličine liste proizvoda, </span>
<span class="hljs-comment">// koristi se za određivanje broja elemenata u RecyclerView-u</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getItemCount</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> kosarica.getProizvodi().size();
}
</div></code></pre>
<p>Sada možemo koristiti <code>KosaricaAdapter</code> u <code>MainActivity.java</code>:</p>
<ul>
<li>Inicijaliziramo UI elemente i postavljamo početni ukupni iznos</li>
<li>Postavljamo <code>OnClickListener</code> za gumb dodavanja proizvoda</li>
<li>Inicijaliziramo <code>RecyclerView</code> i <code>KosaricaAdapter</code>, te postavljamo listener za ažuriranje ukupnog iznosa</li>
<li>Dodajemo razdjelnike između stavki i postavljamo adapter na RecyclerView</li>
<li>Metoda <code>updateTotalAmount()</code> ažurira prikaz ukupnog iznosa u TextView-u</li>
<li>Metoda <code>dodajProizvod()</code> dodaje novi proizvod u košaricu i obavještava adapter o promjeni podataka</li>
</ul>
<pre class="hljs"><code><div>    ...
    TextView textSveukupno;
    Button dugmeDodaj;
    EditText textProizvod;
    EditText textCijena;

    RecyclerView recycler;
    KosaricaAdapter adapter;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
        ...
        <span class="hljs-comment">// Inicijalizacija UI elemenata</span>
        textSveukupno = findViewById(R.id.textSveukupno);
        dugmeDodaj = findViewById(R.id.btnDodaj);
        textProizvod = findViewById(R.id.inputNaziv);
        textCijena = findViewById(R.id.inputCijena);

        updateTotalAmount(); <span class="hljs-comment">// Postavljanje početnog ukupnog iznosa</span>
        dugmeDodaj.setOnClickListener(v -&gt; dodajProizvod());

        <span class="hljs-comment">// Postavljanje RecyclerView i adaptera</span>
        recycler = findViewById(R.id.myRecyclerView);
        adapter = <span class="hljs-keyword">new</span> KosaricaAdapter(kosarica);

        <span class="hljs-comment">// Postavljanje listenera za ažuriranje ukupnog iznosa</span>
        adapter.setOnItemsChangedListener(<span class="hljs-keyword">this</span>::updateTotalAmount);

        <span class="hljs-comment">// Dodavanje razdjelnika između stavki i postavljanje adaptera</span>
        recycler.addItemDecoration(<span class="hljs-keyword">new</span> DividerItemDecoration(<span class="hljs-keyword">this</span>, DividerItemDecoration.VERTICAL));
        recycler.setAdapter(adapter);
    }

    <span class="hljs-comment">// Metoda za ažuriranje ukupnog iznosa u TextView-u</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateTotalAmount</span><span class="hljs-params">()</span> </span>{
        String totalText = String.valueOf(kosarica.ukupanIznos());
        textSveukupno.setText(totalText);
    }

    <span class="hljs-comment">// Metoda za dodavanje novog proizvoda u košaricu</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dodajProizvod</span><span class="hljs-params">()</span> </span>{

        String nazivProizvoda = textProizvod.getText().toString();
        <span class="hljs-keyword">double</span> cijenaProizvoda = Double.parseDouble(textCijena.getText().toString());
        Proizvod noviProizvod = <span class="hljs-keyword">new</span> Proizvod(nazivProizvoda, cijenaProizvoda, <span class="hljs-number">1</span>);

        kosarica.dodajProizvod(noviProizvod);
        updateTotalAmount(); <span class="hljs-comment">// Postavljanje početnog ukupnog iznosa</span>

        <span class="hljs-comment">// Obavještavanje adaptera o promjeni podataka</span>
        adapter.notifyDataSetChanged();
    }
}
</div></code></pre>
<div style="width: fit-content; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: center;">
        <img src="slike/kosarica.png" style="border: solid 1px lightgray; border-radius: 8px;"/>
    </div>
    <br/>
    <p style="margin-top: -16px; width: 100%; text-align: center;"><i>Kosarica recycler view</i></p>
</div>
<h3 id="a%C5%BEuriranje-recyclerview">Ažuriranje RecyclerView</h3>
<p>Kada se podaci u adapteru promijene, potrebno je obavijestiti <em>RecyclerView</em> da treba osvježiti prikaz. To se radi pozivom metode <strong><code>notifyDataSetChanged()</code></strong> unutar adaptera.</p>
<pre class="hljs"><code><div>    ...
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setItems</span><span class="hljs-params">(List&lt;String&gt; newItems)</span> </span>{
        <span class="hljs-keyword">this</span>.items = newItems;
        notifyDataSetChanged();
    }
    ...
</div></code></pre>
<p><strong><code>notifyDataSetChanged()</code></strong> koristimo kada se podaci u adapteru promijene i želimo da RecyclerView ponovno nacrta sve elemente.</p>
<ul>
<li>Bez ovog poziva RecyclerView neće automatski osvježiti prikaz, pa će stari podaci ostati prikazani</li>
<li>Ova metoda obavještava adapter da su svi itemi potencijalno promijenjeni i da je potrebno ponovno izračunavanje svih ViewHolder-a</li>
<li>Koristi se npr. nakon dodavanja, brisanja ili izmjene elemenata u listi podataka</li>
</ul>
<blockquote>
<p>U praksi se <strong><code>notifyDataSetChanged()</code></strong> rijetko koristi jer ponovno bindanje svih itema nije učinkovito. Bolje je koristiti <strong><code>DiffUtil</code></strong> ili specifične metode poput <code>notifyItemInserted()</code>, <code>notifyItemRemoved()</code> ili <code>notifyItemChanged()</code> koje osvježavaju samo promijenjene elemente, što poboljšava performanse RecyclerView-a.</p>
</blockquote>
<p>Možemo implementirati notifyItemRemoved() u <code>KosaricaAdapter</code> unutar <code>buttonRemove</code> OnClickListener-a:</p>
<pre class="hljs"><code><div>buttonRemove.setOnClickListener(view -&gt; {
    kosarica.ukloniProizvod(proizvod);
    notifyItemRemoved(position);
    itemsChangedListener.onItemChanged();
});
</div></code></pre>
<blockquote>
<p>Potrebno je proslijediti <code>position</code> u <code>postaviProizvod()</code> metodu kako bi se znao točan položaj proizvoda koji se uklanja.</p>
</blockquote>
<p>Možemo implementirati dodajProizvod() u <code>MainActivity</code> bez korištenja <code>notifyDataSetChanged()</code>:</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dodajProizvod</span><span class="hljs-params">()</span> </span>{
    String nazivProizvoda = textProizvod.getText().toString();
    <span class="hljs-keyword">double</span> cijenaProizvoda = Double.parseDouble(textCijena.getText().toString());
    Proizvod noviProizvod = <span class="hljs-keyword">new</span> Proizvod(nazivProizvoda, cijenaProizvoda, <span class="hljs-number">1</span>);

    kosarica.dodajProizvod(noviProizvod);
    <span class="hljs-comment">// Obavještavanje adaptera o dodavanju novog proizvoda</span>
    <span class="hljs-comment">// size() - 1 jer je novi proizvod dodan na kraj liste</span>
    adapter.notifyItemInserted(kosarica.getProizvodi().size() - <span class="hljs-number">1</span>);
    updateTotalAmount();
}
</div></code></pre>
<p>Drugi način je korištenje <strong>DiffUtil</strong> klase koja omogućuje efikasno izračunavanje razlika između starih i novih podataka te ažuriranje samo onih elemenata koji su se promijenili.
Napravit ćemo klasu <code>KosaricaDiffCallback</code> koja nasljeđuje <code>DiffUtil.Callback</code> i implementira potrebne metode za usporedbu starih i novih podataka.</p>
<ul>
<li>KosaricaDiffCallback prima dvije liste proizvoda: staru i novu</li>
<li>Implementira metode za dobivanje veličine starih i novih lista, te za usporedbu stavki i njihovog sadržaja.</li>
<li><code>areItemsTheSame()</code> provjerava jesu li stavke iste</li>
<li><code>areContentsTheSame()</code> provjerava jesu li svojstva stavki ista (<em>npr. naziv, cijena, količina</em>)</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KosaricaDiffCallback</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DiffUtil</span>.<span class="hljs-title">Callback</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Proizvod&gt; oldProizvodi;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Proizvod&gt; newProizvodi;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">KosaricaDiffCallback</span><span class="hljs-params">(List&lt;Proizvod&gt; oldProizvodi, List&lt;Proizvod&gt; newProizvodi)</span> </span>{
        <span class="hljs-keyword">this</span>.oldProizvodi = oldProizvodi;
        <span class="hljs-keyword">this</span>.newProizvodi = newProizvodi;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getOldListSize</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> oldProizvodi.size(); }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getNewListSize</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> newProizvodi.size(); }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">areItemsTheSame</span><span class="hljs-params">(<span class="hljs-keyword">int</span> oldItemPosition, <span class="hljs-keyword">int</span> newItemPosition)</span> </span>{
        <span class="hljs-keyword">return</span> oldProizvodi.get(oldItemPosition).equals(newProizvodi.get(newItemPosition));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">areContentsTheSame</span><span class="hljs-params">(<span class="hljs-keyword">int</span> oldItemPosition, <span class="hljs-keyword">int</span> newItemPosition)</span> </span>{
        <span class="hljs-keyword">return</span> (oldProizvodi.get(oldItemPosition).getNaziv().equals(newProizvodi.get(newItemPosition).getNaziv()) &amp;&amp;
                oldProizvodi.get(oldItemPosition).getCijena()==newProizvodi.get(newItemPosition).getCijena() &amp;&amp;
                oldProizvodi.get(oldItemPosition).getKolicina()==newProizvodi.get(newItemPosition).getKolicina());
    }
}
</div></code></pre>
<p>Zatim ćemo u <code>KosaricaAdapter</code> implementirati metodu <code>setProizvodi()</code> koja koristi <code>DiffUtil</code> za izračunavanje razlika između starih i novih podataka te ažuriranje RecyclerView-a, te dodati <code>setProizvodi()</code> metodu u <code>Kosarica</code>:</p>
<pre class="hljs"><code><div>    <span class="hljs-comment">// Metoda za postavljanje novih proizvoda u adapter koristeći DiffUtil</span>
    ...
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setProizvodi</span><span class="hljs-params">(List&lt;Proizvod&gt; newProizvodi)</span> </span>{
        DiffUtil.DiffResult diffResult = DiffUtil.calculateDiff(
            <span class="hljs-keyword">new</span> KosaricaDiffCallback(kosarica.getProizvodi(), newProizvodi)
        );
        <span class="hljs-comment">// Ažuriranje liste proizvoda u kosarici</span>
        kosarica.setProizvodi(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(newProizvodi));
        <span class="hljs-comment">// Obavještavanje adaptera o promjenama koristeći DiffUtil rezultat</span>
        diffResult.dispatchUpdatesTo(<span class="hljs-keyword">this</span>);
    }
    ...
    <span class="hljs-comment">// U Kosarica klasi dodajemo setProizvodi metodu</span>
    ...
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setProizvodi</span><span class="hljs-params">(List&lt;Proizvod&gt; proizvodi)</span> </span>{ <span class="hljs-keyword">this</span>.proizvodi = proizvodi; }
    ...
</div></code></pre>
<p>Sada možemo koristiti <code>setProizvodi()</code> metodu u <code>MainActivity</code> umjesto <code>notifyDataSetChanged()</code>:</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dodajProizvod</span><span class="hljs-params">()</span> </span>{
    String nazivProizvoda = textProizvod.getText().toString();
    <span class="hljs-keyword">double</span> cijenaProizvoda = Double.parseDouble(textCijena.getText().toString());
    Proizvod noviProizvod = <span class="hljs-keyword">new</span> Proizvod(nazivProizvoda, cijenaProizvoda, <span class="hljs-number">1</span>);

    <span class="hljs-comment">// Kreiranje nove instance Kosarica s ažuriranim proizvodima</span>
    Kosarica newKosarica = <span class="hljs-keyword">new</span> Kosarica();
    newKosarica.setProizvodi(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(kosarica.getProizvodi()));
    newKosarica.dodajProizvod(noviProizvod);
    <span class="hljs-comment">// Ažuriranje adaptera s novom listom proizvoda koristeći DiffUtil</span>
    adapter.setProizvodi(newKosarica.getProizvodi());
    <span class="hljs-comment">// Ažuriranje ukupnog iznosa</span>
    updateTotalAmount();
}
</div></code></pre>
<p>Isto tako možemo koristiti <code>setProizvodi()</code> metodu unutar <code>buttonRemove</code> OnClickListener-a u <code>KosaricaAdapter</code>:</p>
<pre class="hljs"><code><div>buttonRemove.setOnClickListener(view -&gt; {
    <span class="hljs-comment">// Kreiranje nove instance Kosarica s ažuriranim proizvodima</span>
    Kosarica newKosarica = <span class="hljs-keyword">new</span> Kosarica();
    newKosarica.setProizvodi(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(kosarica.getProizvodi()));
    newKosarica.ukloniProizvod(proizvod);
    <span class="hljs-comment">// Ažuriranje adaptera s novom listom proizvoda koristeći DiffUtil</span>
    setProizvodi(newKosarica.getProizvodi());
    <span class="hljs-comment">// Ažuriranje ukupnog iznosa</span>
    itemsChangedListener.onItemChanged();
});
</div></code></pre>
</div>
</body>
</html>
